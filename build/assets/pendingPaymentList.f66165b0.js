import{s as q,t as B,r as m,v as d,x as h,N as v,br as D,a as f,d as P,e,f as u,J as C,O as t,L as _,M as Q,z as c,Z as S,az as z,B as N,P as A,K as k}from"./index.c64f1b6d.js";import{Q as T}from"./QMarkupTable.d7c4621b.js";import{Q as V}from"./QPagination.ac3d3a5e.js";import{_ as M,a as Y}from"./addRegistrationFeeDialog.2c1d4aea.js";import{u as F}from"./use-quasar.b7fc9b42.js";import{C as L}from"./loadiingApi.44cf2908.js";import"./QBar.8e2bd629.js";import"./QTooltip.081fe1d6.js";import"./position-engine.3b8c85f7.js";import"./QSelect.f8032efb.js";import"./QChip.6d12e675.js";import"./QItem.780837a7.js";import"./QItemLabel.7afa1644.js";import"./ClosePopup.c6c34e5e.js";q("proyojonuserkey",{});const $=q("proyojonloginuser",{});d.title="Requesting To Server...";const I=B("pending payment store",()=>{const g=m(1),n=m("Please make sure you have paid correct amount or the transaction id is correct"),p=m(null),o=m(!1);return{currentPage:g,rejectNote:n,pendingPaymentList:p,pendingPaymentListLoading:o,getPendingPaymentList:async()=>{L("pending-payment-list").showLoading();const r={method:"get",url:"api/payments/pending",headers:{"Content-Type":"application/json",Authorization:`Bearer ${$.value.token}`},params:{pageSize:1,pageNumber:g.value}};o.value=!0;try{const l=await h.request(r);p.value=l.data,o.value=!1,L("pending-payment-list").hideLoading()}catch(l){console.log(l),L("pending-payment-list").hideLoading(),v.create({position:"center",type:"negative",message:"Couldn't get payment list"}),o.value=!1}},approvePayment:async r=>{const l={method:"put",url:"api/payments/"+r,headers:{"Content-Type":"application/json",Authorization:`Bearer ${$.value.token}`},data:{note:"",status:"approved"}};o.value=!0,d.showLoader();try{const s=await h.request(l);p.value=s.data,d.hideLoader(),o.value=!1}catch(s){console.log(s),d.hideLoader(),v.create({position:"center",type:"negative",message:"Couldn't get payment list"}),o.value=!1}},rejectPayment:async r=>{const l={method:"put",url:"api/payments/"+r,headers:{"Content-Type":"application/json",Authorization:`Bearer ${$.value.token}`},data:{note:n.value,status:"rejected"}};o.value=!0,d.showLoader();try{const s=await h.request(l);p.value=s.data,d.hideLoader(),o.value=!1}catch(s){console.log(s),d.hideLoader(),v.create({position:"center",type:"negative",message:"Couldn't get payment list"}),o.value=!1}}}}),H={class:"container-section-py-sm"},O={class:"inner-section"},U={class:"full-width"},E={class:"bg-blue-grey-2"},re={__name:"pendingPaymentList",setup(g){const n=I();n.getPendingPaymentList();const p=()=>{n.getPendingPaymentList()},o=F(),{t:b}=D(),j=a=>{o.dialog({title:b("reject"),message:"Are you sure to reject this?",prompt:{model:"",type:"text"},cancel:!0,persistent:!0}).onOk(r=>{n.rejectNote=r,n.rejectPayment(a)})};return(a,r)=>(f(),P(_,null,[e("div",H,[e("div",O,[e("div",U,[u(z,{class:"border-primary q-pa-md"},{default:C(()=>{var l;return[e("div",null,[u(T,{flat:"",bordered:"",separator:"cell",class:"text-left"},{default:C(()=>{var s;return[e("thead",E,[e("tr",null,[e("th",null,t(a.$t("serial")),1),e("th",null,t(a.$t("issue_date")),1),e("th",null,t(a.$t("transactionId")),1),e("th",null,t(a.$t("amount")),1),e("th",null,t(a.$t("premium_account_periods")),1),e("th",null,t(a.$t("status")),1),e("th",null,t(a.$t("paymentfor")),1),e("th",null,t(a.$t("note")),1),e("th",null,t(a.$t("action")),1)])]),e("tbody",null,[(f(!0),P(_,null,Q((s=c(n).pendingPaymentList)==null?void 0:s.payments,(i,y)=>(f(),P("tr",{key:y,class:N({"bg-blue-grey-1":y%2!=0})},[e("td",null,t(y),1),e("td",null,t(c(A).formatDate(i.createdAt,"YYYY-MM-DD  HH:mm:ss")),1),e("td",null,t(i.transactionId),1),e("td",null,t(i.amount),1),e("td",null,t(i.periods),1),e("td",null,t(i.status),1),e("td",null,t(i.paymentFor),1),e("td",null,t(i.note),1),e("td",null,[u(k,{label:a.$t("approved"),color:"positive",onClick:w=>c(n).approvePayment(i._id)},null,8,["label","onClick"]),u(k,{label:a.$t("reject"),color:"negative",onClick:w=>j(i._id)},null,8,["label","onClick"])])],2))),128))])]}),_:1}),u(S,{class:"q-mt-md"}),u(V,{class:"q-mt-md",color:"blue-grey-7",modelValue:c(n).currentPage,"onUpdate:modelValue":[r[0]||(r[0]=s=>c(n).currentPage=s),p],max:(l=c(n).pendingPaymentList)==null?void 0:l.pages,"max-pages":6,"boundary-numbers":""},null,8,["modelValue","max"])])]}),_:1})])])]),u(M),u(Y)],64))}};export{re as default};
