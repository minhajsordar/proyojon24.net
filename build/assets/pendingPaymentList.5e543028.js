import{s as q,t as B,r as m,v as D,C as u,x as h,N as v,bp as N,a as f,d as P,e,f as d,K as C,P as t,M as _,O as Q,z as c,_ as S,aA as A,B as z,R as T,L as k}from"./index.38157739.js";import{Q as V}from"./QMarkupTable.0373befc.js";import{Q as I}from"./QPagination.41ea0dfb.js";import{_ as M,a as Y}from"./addRegistrationFeeDialog.6f9f423f.js";import{u as F}from"./use-quasar.1bc3f6f9.js";import"./QSpace.88433820.js";import"./QTooltip.d2c0997a.js";import"./position-engine.80cb561b.js";import"./QBar.e13b2488.js";import"./QSelect.f67ac5e6.js";import"./QChip.98243e5c.js";import"./QItem.064bebb7.js";import"./ClosePopup.e90125de.js";q("proyojonuserkey",{});const L=q("proyojonloginuser",{});D.title="Requesting To Server...";const H=B("pending payment store",()=>{const g=m(1),n=m("Please make sure you have paid correct amount or the transaction id is correct"),p=m(null),s=m(!1);return{currentPage:g,rejectNote:n,pendingPaymentList:p,pendingPaymentListLoading:s,getPendingPaymentList:async()=>{u("pending-payment-list").showLoading();const r={method:"get",url:"api/payments/pending",headers:{"Content-Type":"application/json",Authorization:`Bearer ${L.value.token}`},params:{pageSize:30,pageNumber:g.value}};s.value=!0;try{const l=await h.request(r);p.value=l.data,s.value=!1,u("pending-payment-list").hideLoading()}catch(l){console.log(l),u("pending-payment-list").hideLoading(),v.create({position:"center",type:"negative",message:"Couldn't get payment list"}),s.value=!1}},approvePayment:async r=>{const l={method:"put",url:"api/payments/"+r,headers:{"Content-Type":"application/json",Authorization:`Bearer ${L.value.token}`},data:{note:"",status:"approved"}};s.value=!0,u("put-payments").showLoading();try{const o=await h.request(l);p.value=o.data,u("put-payments").hideLoading(),s.value=!1}catch(o){console.log(o),u("put-payments").hideLoading(),v.create({position:"center",type:"negative",message:"Couldn't get payment list"}),s.value=!1}},rejectPayment:async r=>{const l={method:"put",url:"api/payments/"+r,headers:{"Content-Type":"application/json",Authorization:`Bearer ${L.value.token}`},data:{note:n.value,status:"rejected"}};s.value=!0,u("put-payments-id").showLoading();try{const o=await h.request(l);p.value=o.data,u("put-payments-id").hideLoading(),s.value=!1}catch(o){console.log(o),u("put-payments-id").hideLoading(),v.create({position:"center",type:"negative",message:"Couldn't get payment list"}),s.value=!1}}}}),O={class:"container-section-py-sm"},R={class:"inner-section"},U={class:"full-width"},E={class:"bg-blue-grey-2"},re={__name:"pendingPaymentList",setup(g){const n=H();n.getPendingPaymentList();const p=()=>{n.getPendingPaymentList()},s=F(),{t:$}=N(),b=a=>{s.dialog({title:$("reject"),message:"Are you sure to reject this?",prompt:{model:"",type:"text"},cancel:!0,persistent:!0}).onOk(r=>{n.rejectNote=r,n.rejectPayment(a)})};return(a,r)=>(f(),P(_,null,[e("div",O,[e("div",R,[e("div",U,[d(A,{class:"border-primary q-pa-md"},{default:C(()=>{var l;return[e("div",null,[d(V,{flat:"",bordered:"",separator:"cell",class:"text-left"},{default:C(()=>{var o;return[e("thead",E,[e("tr",null,[e("th",null,t(a.$t("serial")),1),e("th",null,t(a.$t("issue_date")),1),e("th",null,t(a.$t("userId")),1),e("th",null,t(a.$t("transactionId")),1),e("th",null,t(a.$t("amount")),1),e("th",null,t(a.$t("premium_account_periods")),1),e("th",null,t(a.$t("status")),1),e("th",null,t(a.$t("paymentfor")),1),e("th",null,t(a.$t("note")),1),e("th",null,t(a.$t("action")),1)])]),e("tbody",null,[(f(!0),P(_,null,Q((o=c(n).pendingPaymentList)==null?void 0:o.payments,(i,y)=>{var j;return f(),P("tr",{key:y,class:z({"bg-blue-grey-1":y%2!=0})},[e("td",null,t(y),1),e("td",null,t(c(T).formatDate(i.createdAt,"YYYY-MM-DD  HH:mm:ss")),1),e("td",null,t((j=i.user)==null?void 0:j.registrationNo),1),e("td",null,t(i.transactionId),1),e("td",null,t(i.amount),1),e("td",null,t(i.periods),1),e("td",null,t(i.status),1),e("td",null,t(i.paymentFor),1),e("td",null,t(i.note),1),e("td",null,[d(k,{label:a.$t("approved"),color:"positive",onClick:w=>c(n).approvePayment(i._id)},null,8,["label","onClick"]),d(k,{label:a.$t("reject"),color:"negative",onClick:w=>b(i._id)},null,8,["label","onClick"])])],2)}),128))])]}),_:1}),d(S,{class:"q-mt-md"}),d(I,{class:"q-mt-md",color:"blue-grey-7",modelValue:c(n).currentPage,"onUpdate:modelValue":[r[0]||(r[0]=o=>c(n).currentPage=o),p],max:(l=c(n).pendingPaymentList)==null?void 0:l.pages,"max-pages":6,"boundary-numbers":""},null,8,["modelValue","max"])])]}),_:1})])])]),d(M),d(Y)],64))}};export{re as default};
