import{G as S,aD as A,r as g,bc as D,bd as l,be as v,Z as f,bf as w,a as P,d as L,e,f as u,q as j,B as t,K as k,bj as B,y as p,A as Q,s as N,H as z,a3 as F,x as _}from"./index.fd4a4410.js";import{Q as T}from"./QMarkupTable.4517fe25.js";import{Q as V}from"./QPagination.8223c037.js";import{_ as I,a as Y}from"./addRegistrationFeeDialog.6887a1f3.js";import{u as H}from"./use-quasar.a19ccf18.js";import{u as M}from"./pendingForApprovalListCountStore.f46cd555.js";import"./QSpace.186b920a.js";import"./QTooltip.6e061f2a.js";import"./position-engine.64a06537.js";import"./QBar.10083e57.js";import"./QSelect.c6b40a90.js";import"./QChip.1f214d2d.js";import"./QItemLabel.02c24a5e.js";import"./ClosePopup.c97f6f88.js";S("proyojonuserkey",{});const b=S("proyojonloginuser",{});D.title="Requesting To Server...";const U=A("pending payment store",()=>{const y=M(),o=g(1),m=g("Please make sure you have paid correct amount or the transaction id is correct"),d=g(null),s=g(!1);return{currentPage:o,rejectNote:m,pendingPaymentList:d,pendingPaymentListLoading:s,getPendingPaymentList:async()=>{l("pending-payment-list").showLoading();const i={method:"get",url:"api/payments/pending",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b.value.token}`},params:{pageSize:30,pageNumber:o.value}};s.value=!0;try{const r=await v.request(i);d.value=r.data,s.value=!1,l("pending-payment-list").hideLoading()}catch(r){console.log(r),l("pending-payment-list").hideLoading(),f.create({position:"center",type:"negative",message:"Couldn't get payment list"}),s.value=!1}},approvePayment:async i=>{const r={method:"put",url:"api/payments/"+i,headers:{"Content-Type":"application/json",Authorization:`Bearer ${b.value.token}`},data:{note:"",status:"approved"}};s.value=!0,l("put-payments").showLoading();try{const a=await v.request(r);d.value=a.data,l("put-payments").hideLoading(),s.value=!1,y.getPendingCount()}catch(a){console.log(a),l("put-payments").hideLoading(),f.create({position:"center",type:"negative",message:"Couldn't get payment list"}),s.value=!1}},rejectPayment:async i=>{const r={method:"put",url:"api/payments/"+i,headers:{"Content-Type":"application/json",Authorization:`Bearer ${b.value.token}`},data:{note:m.value,status:"rejected"}};s.value=!0,l("put-payments-id").showLoading();try{const a=await v.request(r);d.value=a.data,l("put-payments-id").hideLoading(),s.value=!1,y.getPendingCount()}catch(a){console.log(a),l("put-payments-id").hideLoading(),f.create({position:"center",type:"negative",message:"Couldn't get payment list"}),s.value=!1}}}}),E={class:"container-section-py-sm"},G={class:"inner-section"},K={class:"full-width"},O={class:"bg-blue-grey-2"},ie={__name:"pendingPaymentList",setup(y){const o=U();o.getPendingPaymentList();const m=()=>{o.getPendingPaymentList()},d=H(),{t:s}=w(),$=n=>{d.dialog({title:s("reject"),message:"Are you sure to reject this?",prompt:{model:"",type:"text"},cancel:!0,persistent:!0}).onOk(c=>{o.rejectNote=c,o.rejectPayment(n)})};return(n,c)=>(P(),L(k,null,[e("div",E,[e("div",G,[e("div",K,[u(N,{class:"border-primary q-pa-md"},{default:j(()=>{var i;return[e("div",null,[u(T,{flat:"",bordered:"",separator:"cell",class:"text-left"},{default:j(()=>{var r;return[e("thead",O,[e("tr",null,[e("th",null,t(n.$t("serial")),1),e("th",null,t(n.$t("issue_date")),1),e("th",null,t(n.$t("userId")),1),e("th",null,t(n.$t("transactionId")),1),e("th",null,t(n.$t("amount")),1),e("th",null,t(n.$t("premium_account_periods")),1),e("th",null,t(n.$t("status")),1),e("th",null,t(n.$t("paymentfor")),1),e("th",null,t(n.$t("note")),1),e("th",null,t(n.$t("action")),1)])]),e("tbody",null,[(P(!0),L(k,null,B((r=p(o).pendingPaymentList)==null?void 0:r.payments,(a,h)=>{var C;return P(),L("tr",{key:h,class:z({"bg-blue-grey-1":h%2!=0})},[e("td",null,t(h),1),e("td",null,t(p(F).formatDate(a.createdAt,"YYYY-MM-DD  HH:mm:ss")),1),e("td",null,t((C=a.user)==null?void 0:C.registrationNo),1),e("td",null,t(a.transactionId),1),e("td",null,t(a.amount)+" "+t(n.$currency_sign),1),e("td",null,t(a.periods),1),e("td",null,t(a.status),1),e("td",null,t(a.paymentFor),1),e("td",null,t(a.note),1),e("td",null,[u(_,{label:n.$t("approved"),color:"positive",onClick:q=>p(o).approvePayment(a._id)},null,8,["label","onClick"]),u(_,{label:n.$t("reject"),color:"negative",onClick:q=>$(a._id)},null,8,["label","onClick"])])],2)}),128))])]}),_:1}),u(Q,{class:"q-mt-md"}),u(V,{class:"q-mt-md",color:"blue-grey-7",modelValue:p(o).currentPage,"onUpdate:modelValue":[c[0]||(c[0]=r=>p(o).currentPage=r),m],max:(i=p(o).pendingPaymentList)==null?void 0:i.pages,"max-pages":6,"boundary-numbers":""},null,8,["modelValue","max"])])]}),_:1})])])]),u(I),u(Y)],64))}};export{ie as default};
