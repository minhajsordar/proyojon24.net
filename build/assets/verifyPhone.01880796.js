import{t as y,H as d,u as v,r as l,v as m,x as a,N as s,br as C}from"./index.9bf41d52.js";m.title="Requesting To Server...";const _=y("otp verification store",()=>{const o=d(),p=v(),r=l(!1),n=l(""),u=()=>{r.value=!0,n.value=""},f=async t=>{const e={method:"post",url:"api/otp/request_phone_verification_otp",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o.loginUserInfo.token}`},data:{phone:o.loginUserInfo.phone}};try{const i=await a.request(e);s.create({position:"center",type:"positive",message:"Otp Sent successfully"}),t()}catch(i){console.log(i),s.create({position:"center",type:"negative",message:"Could not send OTP. Server error."})}},h=async()=>{const t={method:"post",url:"api/otp/request_phone_verification_otp",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o.loginUserInfo.token}`},data:{phone:o.loginUserInfo.phone}};try{await a.request(t),C.create({title:"Check your phone for otp",message:"Enter otp or verify from https://proyojon24.net/profile",ok:{push:!0},persistent:!0,prompt:{model:"",type:"text"}}).onOk(e=>{c(e)}).onCancel(()=>{p.push("/login")})}catch(e){console.log(e),s.create({position:"center",type:"negative",message:"Could not send OTP. Server error."})}},g=async()=>{if(n.value=="")return;const t={method:"post",url:"api/otp/verify_phone",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o.loginUserInfo.token}`},data:{otp:n.value}};try{const e=await a.request(t);o.loginUserInfo.phoneVerified=!0,r.value=!1}catch(e){console.log(e),r.value=!1,s.create({position:"center",type:"negative",message:"Could not verify otp. Try again later."})}},c=async t=>{const e={method:"post",url:"api/otp/verify_phone",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o.loginUserInfo.token}`},data:{otp:t}};try{await a.request(e),o.loginUserInfo.phoneVerified=!0,p.push("/service_provider_profile")}catch(i){console.log(i)}};return{getOtpVerificationCode:f,verifyOtpCode:g,getOtpVerificationCodeWhileRegistration:h,verifyOtpCodeWhileRegistration:c,openOtpVerificationDialog:r,otpInput:n,openOtpVerificationDialogManager:u}});export{_ as u};
